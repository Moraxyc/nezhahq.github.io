import{_ as s,o as a,c as o,R as e}from"./chunks/framework.44fd0451.js";const y=JSON.parse('{"title":"服务器","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"guide/servers.md","filePath":"guide/servers.md","lastUpdated":1710617589000}'),l={name:"guide/servers.md"},n=e(`<h1 id="服务器" tabindex="-1">服务器 <a class="header-anchor" href="#服务器" aria-label="Permalink to &quot;服务器&quot;">​</a></h1><h2 id="介绍" tabindex="-1">介绍 <a class="header-anchor" href="#介绍" aria-label="Permalink to &quot;介绍&quot;">​</a></h2><p>服务器区域负责管理 Agent，是哪吒探针中最基础的区域，也是其他功能的基础。</p><h2 id="新增服务器" tabindex="-1">新增服务器 <a class="header-anchor" href="#新增服务器" aria-label="Permalink to &quot;新增服务器&quot;">​</a></h2><p>第一步是新增服务器，可以自定义名称、分组、排序和备注。<br> 拥有相同分组的服务器会在受支持的主题中划分到一起进行显示，备注仅会在后台显示，无需担心泄露信息。</p><h2 id="安装-agent" tabindex="-1">安装 Agent <a class="header-anchor" href="#安装-agent" aria-label="Permalink to &quot;安装 Agent&quot;">​</a></h2><p>请参考前文<a href="/guide/agent.html">安装 Agent</a><br> 推荐使用一键安装，即<strong>配置好参数后</strong>，点击服务器<strong>一键安装</strong>列上的对应的系统图标即可复制安装命令，在相应服务器上进行安装。</p><h2 id="强制更新" tabindex="-1">强制更新 <a class="header-anchor" href="#强制更新" aria-label="Permalink to &quot;强制更新&quot;">​</a></h2><p>Agent 更新相关的参数是 <a href="/guide/agent.html#自定义agent监控项目">自定义 Agent 监控项目</a> 中的 <code>--disable-auto-update</code> 和 <code>--disable-force-update</code>。<br> 默认情况下，Agent 会自动更新，无需干预。但当用户关闭自动更新后，也可以选中指定服务器进行强制更新。<br><code>disable-force-update</code> 开启时此功能不生效。</p><h2 id="数据列" tabindex="-1">数据列 <a class="header-anchor" href="#数据列" aria-label="Permalink to &quot;数据列&quot;">​</a></h2><ul><li>版本号: 记录 Agent 当前版本</li><li>对游客隐藏： 为 True 时，游客在面板中无法查看到此服务器</li><li>启用DDNS: 为 True 时，当该服务器IP发生变化，Dashboard 会自动更新 DNS 记录</li><li>DDNS域名：为该服务器配置的 DDNS 域名</li><li>密钥: 即 secret\\key，配置 Agent 时会用到，用于验证 Agent 与 Dashboard 的通信</li><li>一键安装: 点击相应的系统按钮，复制命令到服务器执行即可一键安装</li><li>管理: 分别为连接 WebShell，修改服务器配置，删除服务器</li></ul><h2 id="在线终端" tabindex="-1">在线终端 <a class="header-anchor" href="#在线终端" aria-label="Permalink to &quot;在线终端&quot;">​</a></h2><p>即 WebShell，<code>disable-command-execute</code>开启时此功能不生效。<br> Linux 和 Windows 均可用，可使用 Ctrl+Shift+V 粘贴。<br> 连接失败请参考<a href="/guide/q4.html">实时通道断开/在线终端连接失败</a>。<br> 注意在线终端功能中，Agent 也是通过 WebSocket 连接到<strong>公开访问域名</strong>，而非通过 gRPC 交互。</p><h2 id="ddns-功能" tabindex="-1">DDNS 功能 <a class="header-anchor" href="#ddns-功能" aria-label="Permalink to &quot;DDNS 功能&quot;">​</a></h2><p>DDNS 功能适用于使用动态IP的服务器，当检测到当前的服务器 IP 发生变更，Dashboard 会根据配置自动更新 DNS 记录。</p><h3 id="配置说明" tabindex="-1">配置说明 <a class="header-anchor" href="#配置说明" aria-label="Permalink to &quot;配置说明&quot;">​</a></h3><p>DDNS 功能依赖于 DNS 供应商的 API，目前支持 <code>cloudflare</code>。你需要提前在 Cloudflare 上添加一个域名，并创建一个拥有 <code>编辑区域 DNS</code> 权限的令牌。<br> 如果您还不知道如何创建令牌，请参考 <a href="https://developers.cloudflare.com/api/tokens/create" target="_blank" rel="noreferrer">Cloudflare API Token</a>。</p><ol><li><strong>基本配置</strong><br> 在配置文件 <code>/opt/nezha/dashboard/data/config.yaml</code> 中，可以修改 DNS 供应商的 API 信息，如果配置文件中没有 <code>DDNS</code> 配置项，可以手动添加。<div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">DDNS</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">AccessID</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">AccessSecret</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">Enable</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">MaxRetries</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">Provider</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">cloudflare</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">WebhookHeaders</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">WebhookMethod</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">POST</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">WebhookRequestBody</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">WebhookURL</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;&quot;</span></span></code></pre></div></li></ol><ul><li><code>AccessID</code> 是 DNS 供应商的登录账号</li><li><code>AccessSecret</code> 是 DNS 供应商中创建好的令牌</li><li><code>Enable</code> 布尔值，选择是否开启 DDNS 功能</li><li><code>MaxRetries</code> 整数，失败时的重试次数</li><li><code>Provider</code> DNS 供应商的名称</li><li><code>WebhookHeaders</code> 字符串，Webhook 的请求头</li><li><code>WebhookMethod</code> 字符串，Webhook 的请求方法</li><li><code>WebhookRequestBody</code> 字符串，Webhook 的请求体</li><li><code>WebhookURL</code> 字符串，Webhook 的请求地址<br> 配置完成后，重启 Dashboard 即可生效。</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Webhook 相关配置是可选的，如果不需要可以不填写。</p></div><ol start="2"><li><strong>Dashboard 配置</strong><br> 在 Dashboard 中，可以在服务器列表中看到 <code>启用DDNS</code> 和 <code>DDNS域名</code> 两个字段，分别表示是否开启 DDNS 功能和当前的 DDNS 域名。<br> 如果需要开启 DDNS 功能，可以在服务器列表中点击 <code>修改</code> 按钮，然后在弹出的对话框中填写 <code>DDNS域名</code>，并勾选<code>启用DDNS</code>，然后点击 <code>保存</code> 按钮即可。</li></ol><h3 id="查看日志" tabindex="-1">查看日志 <a class="header-anchor" href="#查看日志" aria-label="Permalink to &quot;查看日志&quot;">​</a></h3><p>在 Dashboard 的日志中，可以看到 DDNS 功能的相关日志，配置正确时，更新 DNS 记录时会有相应的日志记录。</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">dashboard_1</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">2024/03/16</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">23</span><span style="color:#C3E88D;">:16:25</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">NEZH</span><span style="color:#A6ACCD;">A</span><span style="color:#89DDFF;">&gt;&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">正在尝试更新域名</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">ddns.example.com</span><span style="color:#89DDFF;">)</span><span style="color:#C3E88D;">DDNS</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">1/3</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#FFCB6B;">dashboard_1</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">2024/03/16</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">23</span><span style="color:#C3E88D;">:16:28</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">NEZH</span><span style="color:#A6ACCD;">A</span><span style="color:#89DDFF;">&gt;&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">尝试更新域名</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">ddns.example.com</span><span style="color:#89DDFF;">)</span><span style="color:#C3E88D;">DDNS成功</span></span></code></pre></div>`,24),p=[n];function t(r,c,d,D,i,h){return a(),o("div",null,p)}const A=s(l,[["render",t]]);export{y as __pageData,A as default};
